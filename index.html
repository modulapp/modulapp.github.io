<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Home - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

    <a href="https://github.com/modulapp/modulapp"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="App.html">App</a><ul class='members'><li data-type='member'><a href="App.html#.events">events</a></li><li data-type='member'><a href="App.html#.status">status</a></li><li data-type='member'><a href="App.html#id">id</a></li><li data-type='member'><a href="App.html#config">config</a></li><li data-type='member'><a href="App.html#options">options</a></li><li data-type='member'><a href="App.html#status">status</a></li></ul><ul class='methods'><li data-type='method'><a href="App.html#addOptions">addOptions</a></li><li data-type='method'><a href="App.html#addConfig">addConfig</a></li><li data-type='method'><a href="App.html#resolve">resolve</a></li><li data-type='method'><a href="App.html#setup">setup</a></li><li data-type='method'><a href="App.html#start">start</a></li><li data-type='method'><a href="App.html#stop">stop</a></li><li data-type='method'><a href="App.html#destroy">destroy</a></li></ul></li><li><a href="Module.html">Module</a><ul class='members'><li data-type='member'><a href="Module.html#.events">events</a></li><li data-type='member'><a href="Module.html#.status">status</a></li><li data-type='member'><a href="Module.html#id">id</a></li><li data-type='member'><a href="Module.html#status">status</a></li><li data-type='member'><a href="Module.html#version">version</a></li><li data-type='member'><a href="Module.html#options">options</a></li><li data-type='member'><a href="Module.html#dependencies">dependencies</a></li></ul><ul class='methods'><li data-type='method'><a href="Module.html#addOptions">addOptions</a></li><li data-type='method'><a href="Module.html#addDependencies">addDependencies</a></li><li data-type='method'><a href="Module.html#setup">setup</a></li><li data-type='method'><a href="Module.html#enable">enable</a></li><li data-type='method'><a href="Module.html#disable">disable</a></li><li data-type='method'><a href="Module.html#destroy">destroy</a></li></ul></li></ul><h3>Events</h3><ul><li><a href="App.html#event:resolving">resolving</a></li><li><a href="App.html#event:resolved">resolved</a></li><li><a href="App.html#event:setting_up">setting_up</a></li><li><a href="App.html#event:setup">setup</a></li><li><a href="App.html#event:starting">starting</a></li><li><a href="App.html#event:started">started</a></li><li><a href="App.html#event:stopping">stopping</a></li><li><a href="App.html#event:stopped">stopped</a></li><li><a href="App.html#event:destroying">destroying</a></li><li><a href="App.html#event:destroyed">destroyed</a></li><li><a href="Module.html#event:setting_up">setting_up</a></li><li><a href="Module.html#event:setup">setup</a></li><li><a href="Module.html#event:enabling">enabling</a></li><li><a href="Module.html#event:enabled">enabled</a></li><li><a href="Module.html#event:disabling">disabling</a></li><li><a href="Module.html#event:disabled">disabled</a></li><li><a href="Module.html#event:destroying">destroying</a></li><li><a href="Module.html#event:destroyed">destroyed</a></li></ul>
</nav>

<div id="main">



















    <section class="readme">
        <article><h1>Modulapp</h1><p>Modular application framework for node.js</p>
<p><a href="https://www.npmjs.com/package/modulapp"><img src="https://img.shields.io/npm/v/modulapp.svg" alt="npm"></a>
<a href="https://www.npmjs.com/package/modulapp"><img src="https://img.shields.io/npm/dm/modulapp.svg" alt="npm"></a>
<a href="https://www.npmjs.com/package/modulapp"><img src="https://img.shields.io/npm/l/modulapp.svg" alt="npm"></a>
<a href=""><img src="https://img.shields.io/node/v/modulapp.svg" alt="node"></a>
<a href="https://github.com/modulapp/modulapp"><img src="https://img.shields.io/david/modulapp/modulapp.svg" alt="David"></a></p>
<p><a href="https://travis-ci.org/modulapp/modulapp"><img src="https://img.shields.io/travis/modulapp/modulapp/master.svg" alt="Travis build"></a>
<a href="https://coveralls.io/github/modulapp/modulapp"><img src="https://img.shields.io/coveralls/modulapp/modulapp.svg" alt="Coveralls"></a>
<a href="https://github.com/modulapp/modulapp"><img src="https://img.shields.io/david/dev/modulapp/modulapp.svg" alt="David"></a></p>
<h2>Overview</h2><p>Modulapp is a framework for defining application in a modular way.
It provides an <code>App</code> class and a <code>Module</code> class.</p>
<h3>Module concept</h3><p>Basically a module is an autonomous part of the application. It could be a npm package or it could be a dedicated file in the app's repository. A module can have dependencies (ie. other modules) and can also provides its own API to other dependants.</p>
<p>A module is an instance of the <code>Module</code> class (which extends EventEmitter). You can add any property and functions to that instance.</p>
<p>Modulapp allows to define hooks for a module. The lifecycle of a module has 4 steps: <code>setup</code>, <code>enable</code>, <code>disable</code> and <code>destroy</code>. A specific behavior of the module can be defined during those 4 steps. It's during those hooks that dependencies and options are injected to the module.</p>
<p>The <code>App</code> instance is managing the lifecycle of all modules and dealing with the dependencies and options.</p>
<h3>App concept</h3><p>The App manages the dependencies and the lifecycle of the modules.</p>
<p>An app is an instance of the <code>App</code> class (which extends EventEmitter). The modules must be declared to the app. Then the lifecycle of the app can be performed. The app's lifecycle is composed of 5 steps:</p>
<ul>
<li><code>resolve</code>: Checks the modules and resolve the dependency tree</li>
<li><code>setup</code>: Synchronously execute the <code>setup</code> hook of every module following the dependency tree order</li>
<li><code>start</code>: Synchronously execute the <code>enable</code> hook of every module following the dependency tree order</li>
<li><code>stop</code>: Synchronously execute the <code>disable</code> hook of every module following the dependency tree reverse order</li>
<li><code>destroy</code>: Synchronously execute the <code>destroy</code> hook of every module following the dependency tree reverse order</li>
</ul>
<p>As the modules are processed synchronously following the dependency tree, the dependencies of a particular module have already been processed before it.</p>
<h2>Usage</h2><p>Install from npm</p>
<pre class="prettyprint source"><code>npm install modulapp</code></pre><p>To write a module, import the <code>Module</code> class.</p>
<pre class="prettyprint source lang-javascript"><code>const Module = require('modulapp').Module;</code></pre><p>To write an app, import the <code>App</code> class.</p>
<pre class="prettyprint source lang-javascript"><code>const App = require('modulapp').App;</code></pre><h2>Example</h2><h3>Module class</h3><pre class="prettyprint source lang-javascript"><code>// myModule.js
const Module = require('modulapp').Module;
let myModule = new Module(&quot;myModule&quot;);

// define the dependencies by referencing other modulapp modules' id
myModule.dependencies = ['server', 'db'];

// custom property
myModule.foo = 'foo';

// custom function
myModule.bar = function() {
    myModule.emit('bar'); // Module extends EventEmitter
};

// overwrite the setup hook
myModule.setup = function(app, imports, options, done) {
    console.log('setting up myModule');
    done(null); // executing the done callback is required
};

// overwrite the enable hook
myModule.enable = function(app, imports, options, done) {
    console.log('enabling myModule');

        let db = imports.db;
        db.on('disconnected', () => {
            // Do some stuff on event
        });

        let server = imports.server
        server.doSomething((err) => {
            if (err) {
                done(err);  // if something wrong return done with the error
            } else {
                done(null);
            }
        });
};

// myModule.disable can also be overwritten
// myModule.destroy can also be overwritten

module.exports = myModule;</code></pre><h3>App class</h3><pre class="prettyprint source lang-javascript"><code>// app.js
const App = require('modulapp').App;
let app = new App();

// Get the modules
let server = require('./server.js');
let db = require('./db.js');
let myModule = require('./myModule.js');

// set the configuration
app.addConfig(server, db, myModule);

// start the application
// start() will itself execute resolve() and setup() if not done
app.start((err) => {
    if (err) {
        console.log(err);
    } else {
        console.log('app started!');
    }
});

someListener.on('destroy app', () => {
    app.stop((err) => {
        if (err) {
            console.log(err);
        } else {
            app.destroy((err) => {
                if (err) {
                    console.log(err);
                } else {
                    console.log('app destroyed!');
                }
            });
        }
    });
});</code></pre></article>
    </section>






</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.2</a> on Sun Nov 13 2016 14:00:54 GMT+0100 (Paris, Madrid) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
